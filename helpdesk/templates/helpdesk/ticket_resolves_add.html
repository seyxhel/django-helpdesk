{% extends "helpdesk/base.html" %}{% load i18n %}

{% block helpdesk_title %}{% trans "Add Ticket as Dependency" %}{% endblock %}

{% block helpdesk_breadcrumb %}
<li class="breadcrumb-item">
    <a href="{% url 'helpdesk:list' %}">{% trans "Tickets" %}</a>
</li>
<li class="breadcrumb-item">
    <a href="{% url 'helpdesk:list' %}{{ depends_on.id }}/">{{ depends_on.queue.slug }}-{{ depends_on.id }}</a>
</li>
<li class="breadcrumb-item active">{% trans "Add Ticket as Dependency" %}</li>
{% endblock %}

{% block helpdesk_body %}
<style>
  :root{
    --brand: #0b5ed7;
    --brand-strong: #084bb5;
    --muted: #6b7280;
    --card-bg: #ffffff;
    --radius-lg: 12px;
    --btn-radius: 22px;
  }

  .page-card { max-width: 680px; margin: 28px auto; }
  .page-card .card { border-radius: var(--radius-lg); box-shadow: 0 10px 30px rgba(15,23,42,0.06); border:1px solid rgba(15,23,42,0.04); background:var(--card-bg); overflow:hidden; }
  .page-card .card-body { padding: 24px; }

  h3.page-title { margin:0 0 6px; font-size:20px; font-weight:700; color:#0f1724; }
  .page-sub { color:var(--muted); font-size:13px; margin-bottom:14px; display:block; }

  .dep-form .form-group { margin-bottom: 12px; }
  .dep-form label { display:block; margin-bottom:6px; font-weight:600; color:#1f2d3d; font-size:13px; }
  .dep-form input, .dep-form select, .dep-form textarea {
    width:100%; height:44px; padding:.5rem .75rem; border-radius:10px; border:1px solid rgba(15,23,42,0.08); box-sizing:border-box; background:#fff;
  }
  .dep-form textarea { min-height: 120px; height:auto; padding-top:.6rem; padding-bottom:.6rem; }

  .helptext { font-size:12px; color:var(--muted); margin-top:6px; }
  .errorlist { color:#dc3545; font-size:13px; margin-top:6px; }

  .note {
    margin:12px 0 18px;
    padding:12px 14px;
    border-radius:8px;
    background:#fff8f2;
    border:1px solid rgba(245,183,77,0.16);
    color:#7a3f00;
    font-size:14px;
  }

  .confirm-actions { padding: 18px 0 0; display:flex; justify-content:center; gap:12px; align-items:center; }
  .confirm-actions .btn {
    height:44px; border-radius:var(--btn-radius); padding:0 18px; display:inline-flex; align-items:center; gap:8px; font-weight:600;
  }
  .btn-cancel { background:#fff; color:#0f1724; border:1px solid rgba(15,23,42,0.08); }
  .btn-primary { background:var(--brand); border:1px solid var(--brand); color:#fff; box-shadow:0 8px 20px rgba(11,94,215,0.12); }
  .btn-primary:hover { background:var(--brand-strong); border-color:var(--brand-strong); transform:translateY(-1px); }

  @media (max-width:576px){
    .page-card .card-body { padding:18px; }
    .confirm-actions { flex-direction:column-reverse; }
    .confirm-actions .btn { width:100%; justify-content:center; }
  }
</style>

<div class="container page-card">
  <div class="card">
    <div class="card-body">
      <h3 class="page-title">{% trans "Add Ticket as Dependency" %}</h3>
      <span class="page-sub">{% trans "Make another ticket block resolving the selected ticket until that ticket is resolved." %}</span>

      <p><strong>{% trans "Ticket:" %}</strong> {{ depends_on }}</p>

      <div class="note">
        {% trans "Adding this ticket as a dependency will prevent the selected ticket being resolved until this ticket has been resolved or closed." %}
      </div>

      <form method="post" action="." class="dep-form" novalidate>
        {% csrf_token %}
        <fieldset>
          <dl>
            {% for field in form %}
              <div class="form-group">
                {{ field.label_tag }}
                {{ field }}
                {% if field.help_text %}<div class="helptext">{{ field.help_text }}</div>{% endif %}
                {% if field.errors %}<div class="errorlist">{{ field.errors|striptags }}</div>{% endif %}
              </div>
            {% endfor %}
          </dl>
        </fieldset>

        <div class="confirm-actions">
          <a href="{{ depends_on.get_absolute_url }}" class="btn btn-cancel" role="button">
            <i class="fas fa-arrow-left"></i>&nbsp;{% trans "Cancel" %}
          </a>
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-save"></i>&nbsp;{% trans "Save Ticket Dependency" %}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
